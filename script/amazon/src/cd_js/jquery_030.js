var executionTimestampsOfEventsFiredOnce=[];!function(e){e.ajaxcall={processXMLResponse:function(t){function a(){e(document).trigger("cdbAjaxComplete")}var r=e.ajaxcall.convertToXml(t);e("response",r).children().each(function(){var t=this.nodeName.toLowerCase(),a=["replaceelement","addelementbefore","addelementafter","appendelement","prependelement","deleteelement"],r=null,s=null,n=null;if(e.inArray(t,a)>=0&&(r=e.ajaxcall.getSelector(e(this)),s=e(r),n=jQuery.trim(e(this).text())),"replaceelement"==t){s.hasClass("ui-dialog-content")&&(s.appendTo("body"),e(".ui-dialog").remove());var i=[];s.find("[data-clearedField]").each(function(){e(this).attr("id")&&i.push("#"+e(this).attr("id"))}),s.replaceWith(n),e.each(i,function(t,a){e(a).val("")}),s.hasClass("layerContent")&&e(".ui-dialog:visible").each(function(){var t=e(this);t.css({top:0,left:0}).position({my:"top",at:"top",of:window,offset:"0 50"}),t.position().top<0&&t.css("top",0)}),e.pluginexecutor.execute(r)}else if("addelementbefore"==t)n=e(n),s.before(n),e.pluginexecutor.execute(n);else if("addelementafter"==t)n=e(n),s.after(n),e.pluginexecutor.execute(n);else if("appendelement"==t)n=e(n),s.append(n),e.pluginexecutor.execute(n);else if("prependelement"==t)n=e(n),s.prepend(n),e.pluginexecutor.execute(n);else if("deleteelement"==t)s.remove(n);else if("addresource"==t){var o=e(this).text();-1===o.indexOf(".js",o.length-3)&&e.ccfregistry.addResource(o)}else if("redirect"==t){var l=e(this).text();window.location.href=l}}),e(document).trigger("cdbAjaxComplete"),window.setTimeout(a,1e3)},processXMLResponseError:function(t){e.ajaxcall.processXMLResponse(t)},convertToXml:function(e){if("string"==typeof e){var t=new DOMParser;try{return t.parseFromString(e,"text/xml")}catch(a){window.console&&(console.log("--- ajaxcall: xml parse error (start) ---"),console.log("XML:"),console.log(e),console.log("--- ajaxcall: xml parse error (end) ---"))}}return e},getSelector:function(e){var t,a,r;return(t=e.attr("id"))?r="#"+t:(a=e.attr("class"))?r="."+a:(r=e.attr("selector"))||window.console&&(console.log("--- ajaxcall: command error (start) ---"),console.log("weder id, class noch selector-Attribut gefunden"),console.log("--- ajaxcall: command error (end) ---")),r}},e.fn.ajaxcall=function(t){var a={event:"click",propagate:!1,url:"",async:!0,syncIE:!1,serializeForm:"",extraParams:"",method:"GET",dataType:"xml",beforeSend:jQuery.noop,complete:jQuery.noop,sendProcessIdOnly:!1,ignoreEmptyFields:!1,onlyOnce:!1,executionTimestamp:null,onLoad:!1,sendRegEx:"",focusForTab:!1};t.onPageLoad?t.event="ready":!0,"undefined"==typeof t.extraParams&&"undefined"!=typeof t.req?t.extraParams=t.req:!0,"undefined"==typeof t.extraParams&&"undefined"!=typeof t.staticParameter?t.extraParams=t.staticParameter:!0;var r=jQuery.extend(a,t),s=function(t,a){var s="",i=!0;if(r.sendRegEx.length>0&&e(t).val()&&(i=null!=e(t).val().match(r.sendRegEx,"i")),i){if(r.sendProcessIdOnly){var o=jQuery(r.serializeForm).serializeArray(),l="undefined"==typeof r.extraParams.processIds?{}:r.extraParams.processIds.split(",");if(jQuery.each(l,function(){var t=this,a=!1;if(""!=t&&e("#"+t).children("input,textarea,select").not(":disabled").each(function(){a=!0,this.id&&(l.push(this.id),-1===r.extraParams.processIds.indexOf(this.id)&&(r.extraParams.processIds+=","+this.id))}),a){var s=r.extraParams.processIds.split(",");r.extraParams.processIds="";for(var n=0;n<s.length;n++)s[n]!=t&&(r.extraParams.processIds+=","+s[n]);r.extraParams.processIds=r.extraParams.processIds.substr(1)}}),l.push("javax.faces.ViewState"),l.push("javax.faces.RenderKitId"),l.length>0)for(var c=o.length-1;c>=0;c--)(r.ignoreEmptyFields&&0===o[c].value.length||l.length>0&&-1===e.inArray(o[c].name,l))&&o.splice(c,1),e("#"+o[c].name).attr("placeholder")===o[c].value&&""!==o[c].value&&o.splice(c,1);e.each(o,function(){var t=e("input[name='"+this.name+"'],select[name='"+this.name+"'],textarea[name='"+this.name+"']").serialize();""!==t&&(s?s+="&":!0,s+=t)})}else r.serializeForm?s=e(r.serializeForm).serialize():!0;if(""!=r.extraParams)for(n in r.extraParams)s?s+="&":!0,s+=n+"="+encodeURIComponent(r.extraParams[n]);jQuery.ajax({url:r.url,async:r.async,type:r.method,data:s,dataType:r.dataType,beforeSend:r.beforeSend,success:function(t){var s="",n=e("input,select,textarea,a",e(a).parents("form:first")).index(e(":focus"));if(e.ajaxcall.processXMLResponse(t),r.focusForTab&&"#"!=s&&!e(s).is(":visible")&&""===r.sendRegEx){var i=e("input,select,textarea,a",e(a).parents("form:first")).index(e(a));n>=i?e("input,select,textarea,a",e(a).parents("form:first")).filter(":gt("+i+")").not(":hidden").not(":disabled").first().focus():e("input,select,textarea,a",e(a).parents("form:first")).filter(":lt("+i+")").not(":hidden").not(":disabled").last().focus()}else r.focusForTab&&"#"!=s&&e(s).is(":visible")&&""===r.sendRegEx&&e(s).focus()},error:e.ajaxcall.processXMLResponseError,complete:r.complete})}return r.propagate};if(this.each(function(){var t="#"+e(this).attr("id");"ready"==r.event?s(this,t):e(this).bind(r.event,function(){s(this,t)})}),r.onlyOnce&&null!=r.executionTimestamp&&-1==e.inArray(r.executionTimestamp,executionTimestampsOfEventsFiredOnce)&&(executionTimestampsOfEventsFiredOnce[executionTimestampsOfEventsFiredOnce.length]=r.executionTimestamp,e(this).trigger(r.event)),r.onLoad){var i=r.event;null!=i&&i.indexOf("click")>=0&&e(this).is("a")&&(e(this).children().click(),i=i.replace("click","")),e(this).trigger(i)}return e(this)}}(jQuery),$.ccfregistry.pluginReady("ajaxcall");