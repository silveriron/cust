!function(e){function t(t){var o=0;return t.parents().each(function(){$this=e(this),"relative"===$this.css("position")&&(o+=$this.offset().top)}),o}function o(o,a,n){if(a.moveTargetNode&&"false"!==String.prototype.toLowerCase.apply(a.moveTargetNode)&&($targetNode="true"!==String.prototype.toLowerCase.apply(a.moveTargetNode)&&e(a.moveTargetNode).length?e(a.moveTargetNode).first():e("body"),$targetNode.append(n),i(n,a)),"center"==a.left&&(o.left=(s.width()-n.width())/2),"string"==typeof a.top&&(o.top="center"==a.top?Math.max((s.height()-n.outerHeight())/2,0):parseInt(a.top,10)/100*s.height()),o.top+n.height()>s.height()-30){var r=s.height()/2-n.height()/2;10>=r?(r=10-t(n),o.position="absolute",o.top=s.scrollTop()+r,o.left+=s.scrollLeft()):(o.position="fixed",o.top=r)}else a.fixed||(o.top+=s.scrollTop(),o.left+=s.scrollLeft()),o.position=a.fixed?"fixed":"absolute";o.left<0&&(o.position="absolute",o.left=0);var l=/android|windows phone|iphone|ipad|ipod/i;return l.test(navigator.userAgent)&&(o.position="absolute"),o}function a(){var t=e("body");t.addClass("printOverlay"),window.print(),t.removeClass("printOverlay")}function n(t){var o=t.data("ecrm");o=o||t.find("[data-ecrm]").data("ecrm"),e.isPlainObject(o)&&window.eCrm&&window.eCrm.log(o)}function i(t,o){t&&o.scope.mustWrap&&(r(o),t.parents("."+o.scope.type+"-scope").length<1&&t.wrap('<div class="'+o.scope.type+"-scope "+o.scope.type+'-scope-overlay"></div>'),e("body").loadStyleguideByScope({scope:o.scope.type,useForceMode:o.scope.useForceMode}))}function r(t){var o=t.scope.type+"-scope-overlay",a=e("."+o);a.length>0&&a.each(function(){e(this).is(":empty")&&e(this).remove()})}if(e&&e.tools&&e.tools.overlay){e.tools.overlay.conf.top="15%",e.tools.overlay.conf.close=".js_closeOverlay",e.tools.overlay.conf.closeOnClick=!0,e.tools.overlay.conf.mask={color:"#000",loadSpeed:200,opacity:.7},e.tools.overlay.conf.autoDraggable=!0,e.tools.overlay.conf.autoDraggableHandle=".head",e.tools.overlay.conf.scope={type:"public",mustWrap:!0,useForceMode:!0};var s=e(window);e.tools.overlay.addEffect("default",function(e,t){var a=this.getConf(),r=this.getOverlay();i(r,a),e=o(e,a,r),r.css(e).fadeIn(a.speed,t),s.on("resize.overlayExtension",function(){e=o(e,a,r),r.css(e)}),n(r)},function(e){s.off("resize.overlayExtension"),this.getOverlay().fadeOut(this.getConf().closeSpeed,e)});var l=17;e.tools.overlay.addEffect("helpLayer",function(t,o){var a=this.getConf(),r=this.getTrigger(),s=this.getOverlay(),p=this;s.detach(),r.parent().append(s),r.on("click.overlayHelpLayer",e.proxy(function(){s.is(":visible")&&(r.off("click.overlayHelpLayer"),this.close())},this)),r.on("onBeforeClose.overlayHelpLayer",function(){r.off("click.overlayHelpLayer onBeforeClose.overlayHelpLayer")}),s.css("z-index",l),l++,i(s,a),$parent=r.parent(),$wrapper=s.parents(".cif-scope-content-wrapper"),offsetLeft=r.offset().left,offsetTop=r.position().top-32,t.position=a.fixed?"fixed":"absolute",t.left=offsetLeft-s.width()-50,t.top=offsetTop,$wrapper.offset().top+$parent.offset().top+t.top+s.height()>$wrapper.offset().top+$wrapper.height()&&(t.top=t.top+r.height()-s.height()),$wrapper.offset().left+$parent.offset().left+t.left<0&&(t.left=0),t.margin=0,$wrapper.offset().top+$wrapper.height()<$parent.offset().top+offsetTop+s.height()&&(t.top=-s.height()+60,s.addClass("align-bottom")),s.css(t).fadeIn(a.speed,o),a.closeOnClick&&e(document).on("click",function(t){p.isOpened()&&!e(t.target).parents(".overlayHelp").length&&p.close(t)}),n(s)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)});var p="js_ajaxWrapper";e.tools.overlay.addEffect("defaultAjax",function(t,r){var l=this,f=this.getOverlay(),d=this.getConf(),c=f.find("."+p),v=f.metadata().ajaxURL;d.moveTargetNode="undefined"!=typeof d.moveTargetNode?d.moveTargetNode:".mainContent","undefined"!=typeof d.ajaxURL&&""!==d.ajaxURL&&(v=d.ajaxURL),e.get(v,function(v){var g=e(v).filter(".overlay"),u=0!==g.length?g:e("<div>"+v+"</div>");if(0!==c.length&&c.remove(),c=e('<div class="'+p+'"></div>'),c.append(u),f.append(c),d.autoDraggable&&!f.hasClass("ui-draggable")){var y=c.find(d.autoDraggableHandle);1==y.length?(f.addClass("ui-draggable"),f.draggable({handle:d.autoDraggableHandle,containment:"window"})):y.length>1&&window.console&&window.console.log&&console.log("expected unique header for selector ",d.autoDraggableHandle,"but found",y)}"undefined"!=typeof e.pluginexecutor&&"undefined"!=typeof e.pluginexecutor.execute&&e.pluginexecutor.execute(u,!1),u.find(d.close).click(l.close),f.data("keepPosition")||(t=o(t,d,f),f.css(t),f.data("keepPosition",!0)),f.is(":visible")&&"1"==f.css("opacity")||(f.css("opacity",""),f.stop().fadeIn(d.speed,r)),i(f,d),f.trigger("overlayAjaxLoaded"),s.on("resize.overlayExtension",function(){t=o(t,d,f),f.css(t)}),f.on("click",".js_printOverlay",function(){a(f)}),window.overlayAPI=l,window.tb_remove=l.close,n(f)})},function(e){s.off("resize.overlayExtension");var t=this.getOverlay();t.find("."+p).remove(),t.off("click",".js_printOverlay"),t.fadeOut(this.getConf().closeSpeed,e),t.data("keepPosition",!1)});var f="videoID1",d="_wrapper";e.tools.overlay.addEffect("defaultVideo",function(t,a){var r=this.getOverlay(),l=this.getConf(),p=e('<div id="'+f+'"></div>'),c=r.find('div[id$="'+d+'"]'),v=r.metadata().videoSettings;if(l.moveTargetNode="undefined"!=typeof l.moveTargetNode?l.moveTargetNode:".mainContent",0!==c.length&&c.remove(),i(r,l),r.append(p),"undefined"!=typeof l.videoSettings&&"undefined"!=typeof l.videoSettings.mp4URL&&""!==l.videoSettings.mp4URL&&(v=l.videoSettings),p.videoplayer(v),0===r.width()){var g=r.find('div[id$="'+d+'"]');r.width(g.outerWidth()).height(g.outerHeight())}t=o(t,l,r),r.css(t).fadeIn(l.speed,a),s.on("resize.overlayExtension",function(){t=o(t,l,r),r.css(t)}),n(r)},function(t){s.off("resize.overlayExtension");var o=this.getOverlay();e().videoplayer.destroy(f),o.find('div[id$="'+d+'"]').remove(),o.fadeOut(this.getConf().closeSpeed,t)}),e.tools.overlay.addEffect("defaultPopup",function(){{var e=this.getOverlay(),t=this.getConf(),o=e.metadata().popupURL,a=e.metadata().features,i=e.metadata().name;e.metadata().newInstance||!1}"undefined"!=typeof t.popupURL&&""!==t.popupURL&&(o=t.popupURL),"undefined"!=typeof t.features&&""!==t.features&&(a=t.features),"undefined"!=typeof t.name&&""!==t.name&&(i=t.name),"boolean"==typeof t.newInstance&&t.newInstance&&(null!=i?i+=(new Date).getTime():i=(new Date).getTime());var r="";if("undefined"!=typeof a&&"[object Object]"===Object.prototype.toString.call(a))for(var s in a)a.hasOwnProperty(s)&&(r+=(0===r.length?"":",")+s+"="+a[s]);window.open(o,i,r),this.close(),n(e)},function(){})}}(jQuery),$.ccfregistry.pluginReady("overlayExtension");